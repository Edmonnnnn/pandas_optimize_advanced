# üèéÔ∏è pandas_optimize_advanced

**–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –±–µ–Ω—á–º–∞—Ä–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Python —Å –ø–æ–º–æ—â—å—é Pandas, Polars –∏ DuckDB**

---

## üìö –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç ‚Äú–±–æ–µ–≤–æ–µ‚Äù —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ —Å —Ñ—Ä–∏–ª–∞–Ω—Å-–ø–ª–æ—â–∞–¥–∫–∏:  
**–ó–∞–¥–∞—á–∞** ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É –¥–∞–Ω–Ω—ã—Ö –ø–æ CSV-—Ñ–∞–π–ª–∞–º, –∏—Å–ø–æ–ª—å–∑—É—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:  
- **–ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç ‚Äú–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ‚Äù Pandas-—Å–∫—Ä–∏–ø—Ç–∞**
- **–ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å pipeline –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ (Polars, DuckDB, Parquet)**
- **–ü—Ä–æ–≤–µ—Å—Ç–∏ —á–µ—Å—Ç–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —É–¥–æ–±—Å—Ç–≤—É, —É–¥–æ–±—Å—Ç–≤—É –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

---

## üö© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–¥–∞—á–∏

- –î–∞–Ω–æ 4 –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞—Ç–∞—Å–µ—Ç–∞:
  - `users.csv` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
  - `products.csv` ‚Äî —Ç–æ–≤–∞—Ä—ã –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
  - `purchases.csv` ‚Äî –ø–æ–∫—É–ø–∫–∏ (–¥–æ 2 –º–ª–Ω —Å—Ç—Ä–æ–∫)
  - `discounts.csv` ‚Äî —Å–∫–∏–¥–∫–∏ –∏ –¥–∞—Ç—ã –¥–µ–π—Å—Ç–≤–∏—è
- –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞/–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞–π—Ç–∏ **—Ç–æ–ø-3 –≥–æ—Ä–æ–¥–∞ –ø–æ –≤—ã—Ä—É—á–∫–µ**, —É—á–∏—Ç—ã–≤–∞—è —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç—ã.

---

## üìà –ö–∞–∫ —Ä–µ—à–∞–ª–∏

### 1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∏–∑—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è real-like –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Å–∫—Ä–∏–ø—Ç–æ–º `generate_data.py`
- –ò–Ω—Å–ø–µ–∫—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: `inspect_data.py`

### 2. **–ë–∞–∑–æ–≤—ã–π (–º–µ–¥–ª–µ–Ω–Ω—ã–π) Pandas-–ø–æ–¥—Ö–æ–¥**
- `slow_analysis.py` ‚Äî –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π Pandas c –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ–º, for-—Ü–∏–∫–ª–∞–º–∏ –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º–∏ DataFrame.
- –ò—Ç–æ–≥:  
  - –ù–∞ 100k+ —Å—Ç—Ä–æ–∫–∞—Ö –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è ‚Äî **–¥–µ—Å—è—Ç–∫–∏ —Å–µ–∫—É–Ω–¥**
  - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: —Å–ª–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª—å—à–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏, —Å–∏–ª—å–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ RAM

### 3. **–ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤—ã—è–≤–ª–µ–Ω–∏–µ —É–∑–∫–∏—Ö –º–µ—Å—Ç**
- –í—ã—è–≤–∏–ª–∏ ‚Äú–±—É—Ç—ã–ª–æ—á–Ω—ã–µ –≥–æ—Ä–ª—ã—à–∫–∏‚Äù:  
  - –ß—Ç–µ–Ω–∏–µ –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (CSV ‚Üí DataFrame)
  - –ú–Ω–æ–≥–æ join/merge/iterrows (—Ü–∏–∫–ª—ã)
  - –ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –Ω—É–∂–Ω—ã–º –∫–æ–ª–æ–Ω–∫–∞–º –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º –Ω–∞ —ç—Ç–∞–ø–µ —á—Ç–µ–Ω–∏—è

### 4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
#### a. **–ü–µ—Ä–µ–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –≤ Parquet**
- –§–∞–π–ª—ã CSV –±—ã–ª–∏ —Ä–∞–∑–æ–≤–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã –≤ Parquet (`csv_to_parquet.py`)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —á—Ç–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –±—ã—Å—Ç—Ä–µ–µ –≤ 5‚Äì20 —Ä–∞–∑!

#### b. **–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ Polars (Lazy Mode)**
- `fast_top_cities_polars_lazy.py` ‚Äî –ª–µ–Ω–∏–≤—ã–π pipeline, –≤—Å–µ join/filter/group –¥–µ–ª–∞—é—Ç—Å—è ‚Äú–≤ –æ–¥–∏–Ω –ø—Ä–æ—Ö–æ–¥‚Äù, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –≤–µ–∫—Ç–æ—Ä–Ω–æ
- –†–µ–∑—É–ª—å—Ç–∞—Ç:  
  - –î–ª—è –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–∏ (~2 –º–ª–Ω —Å—Ç—Ä–æ–∫) –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ: **0.66 —Å–µ–∫**

#### c. **–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ DuckDB (SQL + Parquet)**
- `fast_top_cities_duckdb_fast.py` ‚Äî SQL-–∑–∞–ø—Ä–æ—Å –ø–æ Parquet-—Ñ–∞–π–ª–∞–º, —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π, join –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏–µ–π –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç:  
  - –î–ª—è –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–∏: **0.85 —Å–µ–∫**

#### d. (–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–∞—Å—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å ClickHouse –¥–ª—è —Å—É–ø–µ—Ä-big data, –Ω–æ –Ω–µ –≤–∫–ª—é—á–µ–Ω–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π)

---

## üìä **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ (—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)**

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç         | –í—Ä–µ–º—è (—Å–µ–∫) | –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏                       |
|--------------------|-------------|-----------------------------------|
| Pandas (—Å—Ç–∞—Ä—ã–π)    | 3.7+        | –õ–µ–≥–∫–æ –Ω–∞—á–∞—Ç—å, –Ω–µ—É–¥–æ–±–Ω–æ –¥–ª—è big data |
| Polars (Lazy)      | 0.66        | –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –ª–∞–∫–æ–Ω–∏—á–Ω–æ |
| DuckDB (Parquet)   | 0.85        | SQL-–ø–æ–¥—Ö–æ–¥, –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –∞–¥-—Ö–æ–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |

---

## üöÄ **–ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã**

- **–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (Polars, DuckDB, Parquet) –¥–µ–ª–∞—é—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –∏ join‚Äô—ã –≤ –¥–µ—Å—è—Ç–∫–∏ —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ Pandas ‚Äî –¥–∞–∂–µ –Ω–∞ –Ω–æ—É—Ç–±—É–∫–µ!**
- **–õ–µ–Ω–∏–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (Lazy mode, SQL) –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ —Ü–µ–ø–æ—á–∫–∏ –∑–∞ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã.**
- **–ë–∞–∑–æ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —É—Å–∫–æ—Ä–µ–Ω–∏—è:**
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Parquet –≤–º–µ—Å—Ç–æ CSV
  - –î–µ–ª–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—é —Å—Ä–∞–∑—É –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ (scan + filter + groupby)
  - –ò—Å–∫–ª—é—á–∞—Ç—å –ª–∏—à–Ω–∏–µ –∫–æ–ø–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ DataFrame
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å join —Ç–æ–ª—å–∫–æ –ø–æ –Ω—É–∂–Ω—ã–º –ø–æ–ª—è–º

---

## üì¶ **–ß—Ç–æ –≤–∫–ª—é—á–µ–Ω–æ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**

- `fast_top_cities_polars_lazy.py` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä—ã–π pipeline –Ω–∞ Polars (–ª–µ–Ω–∏–≤—ã–π —Ä–µ–∂–∏–º)
- `fast_top_cities_duckdb_fast.py` ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä—ã–π pipeline –Ω–∞ DuckDB (SQL –ø–æ Parquet)
- `.gitignore` ‚Äî –∏—Å–∫–ª—é—á–∞–µ—Ç –≤—Å–µ –±–æ–ª—å—à–∏–µ/–ª–∏—á–Ω—ã–µ —Ñ–∞–π–ª—ã
- `README.md` ‚Äî —ç—Ç–æ—Ç —Ñ–∞–π–ª

> **CSV, Parquet –∏ –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π!**  
> –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–∏ —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –∏–ª–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —á–µ—Ä–µ–∑ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã.

---

## üí° **–ß—Ç–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ**

- –î–æ–±–∞–≤–∏—Ç—å ClickHouse-–±–µ–Ω—á–º–∞—Ä–∫ (–¥–ª—è truly big data)
- –û—Ñ–æ—Ä–º–∏—Ç—å –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏–ª–∏ –ø–∞–∫–µ—Ç –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ (retention, cohort, LTV –∏ –¥—Ä.)
- –í—ã–Ω–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥-—Ñ–∞–π–ª

---

## üìù **–°–≤—è–∑–∞—Ç—å—Å—è**

–ê–≤—Ç–æ—Ä: [–≤–∞—à–µ –∏–º—è/–Ω–∏–∫]  
GitHub: [–≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å]  
–°–≤—è–∑—å: [–ø–æ—á—Ç–∞ –∏–ª–∏ Telegram, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ]

---

### _–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Ä–æ–±–Ω—É—é –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–π pipeline ‚Äî –ø–∏—à–∏—Ç–µ!_

